import{j as e}from"./index-C9_19nXr.js";import{r as i}from"./react-vendor-KOjhOASN.js";import{n}from"./notesManager-BJrR_Wyu.js";import{a as C,a5 as S,D as B,a6 as A,S as D,a7 as I,W as O,B as R,X as U,a8 as $,F,a9 as q}from"./ui-vendor-DC5Jkz16.js";import"./firebase-vendor-CMaS3_GD.js";import"https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";import"https://www.gstatic.com/firebasejs/12.6.0/firebase-analytics.js";import"https://www.gstatic.com/firebasejs/12.6.0/firebase-messaging.js";const Y=({onNotify:s})=>{const[g,N]=i.useState([]),[r,m]=i.useState(""),[l,p]=i.useState(""),[b,u]=i.useState([]),[j,y]=i.useState(!1);i.useEffect(()=>{c()},[]);const c=()=>{const t=n.getAllNotes();N(t),u(n.getAllTags())},a=t=>{n.deleteNote(t)&&(c(),s("Nota eliminada","success"))},f=()=>{const t=n.exportNotes(),o=new Blob([t],{type:"application/json"}),d=URL.createObjectURL(o),x=document.createElement("a");x.href=d,x.download=`notas-biblicas-${new Date().toISOString().split("T")[0]}.json`,x.click(),URL.revokeObjectURL(d),s("Notas exportadas exitosamente","success")},E=()=>{const t=document.createElement("input");t.type="file",t.accept=".json",t.onchange=o=>{var v;const d=(v=o.target.files)==null?void 0:v[0];if(!d)return;const x=new FileReader;x.onload=z=>{var T;const L=(T=z.target)==null?void 0:T.result,w=n.importNotes(L,!0);w.success?(c(),s(`${w.count} notas importadas`,"success")):s(`Error: ${w.error}`,"error")},x.readAsText(d)},t.click()},k=[...g.filter(t=>{const o=!r||t.noteText.toLowerCase().includes(r.toLowerCase())||t.verseText.toLowerCase().includes(r.toLowerCase())||t.bookName.toLowerCase().includes(r.toLowerCase()),d=!l||t.tags.includes(l);return o&&d})].sort((t,o)=>o.updatedAt-t.updatedAt),h=n.getStats();return e.jsxs("div",{className:"flex-1 overflow-y-auto no-scrollbar bg-gray-50 dark:bg-[#121212] pb-20",children:[e.jsxs("div",{className:"sticky top-0 z-50 bg-gradient-to-r from-purple-600 to-indigo-600 px-6 py-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/20 backdrop-blur-sm flex items-center justify-center",children:e.jsx(C,{size:24,className:"text-white"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("h2",{className:"text-lg font-bold text-white",children:"Mis Notas"}),e.jsxs("p",{className:"text-purple-100 text-sm",children:[g.length," notas guardadas"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>y(!j),className:"p-2 rounded-lg hover:bg-white/10 transition-colors",title:"Estadísticas",children:e.jsx(S,{size:20,className:"text-white"})}),e.jsx("button",{onClick:f,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",title:"Exportar notas",children:e.jsx(B,{size:20,className:"text-white"})}),e.jsx("button",{onClick:E,className:"p-2 rounded-lg hover:bg-white/10 transition-colors",title:"Importar notas",children:e.jsx(A,{size:20,className:"text-white"})})]})]}),e.jsxs("div",{className:"relative mb-3",children:[e.jsx(D,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-white/70",size:20}),e.jsx("input",{type:"text",placeholder:"Buscar en notas...",value:r,onChange:t=>m(t.target.value),className:"w-full pl-10 pr-4 py-2.5 rounded-lg bg-white/20 backdrop-blur-sm text-white placeholder-white/70 border border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50 transition-all"})]}),b.length>0&&e.jsxs("div",{className:"flex items-center gap-2 overflow-x-auto no-scrollbar",children:[e.jsx(I,{size:16,className:"text-white/70 flex-shrink-0"}),e.jsxs("button",{onClick:()=>p(""),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex-shrink-0 ${l?"bg-white/20 backdrop-blur-sm text-white hover:bg-white/30":"bg-white text-purple-600"}`,children:["Todas (",g.length,")"]}),b.map(t=>e.jsxs("button",{onClick:()=>p(t),className:`px-3 py-1.5 rounded-lg text-sm font-medium transition-colors flex-shrink-0 flex items-center gap-1 ${l===t?"bg-white text-purple-600":"bg-white/20 backdrop-blur-sm text-white hover:bg-white/30"}`,children:[e.jsx(O,{size:14}),t," (",h.byTag[t]||0,")"]},t))]})]}),j&&e.jsxs("div",{className:"p-6 bg-gradient-to-br from-primary/10 to-purple-500/10 dark:from-primary/20 dark:to-purple-500/20 border-b border-gray-200 dark:border-gray-800",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(S,{size:20}),"Estadísticas"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-primary",children:h.total}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total de Notas"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:Object.keys(h.byBook).length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Libros con Notas"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:b.length}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Etiquetas"})]}),e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4",children:[e.jsx("div",{className:"text-3xl font-bold text-orange-600",children:Object.keys(h.byBook).length>0?Object.entries(h.byBook).sort((t,o)=>o[1]-t[1])[0][0].substring(0,10):"-"}),e.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Libro Favorito"})]})]})]}),e.jsx("div",{className:"p-6 space-y-4",children:k.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 text-gray-400",children:[e.jsx(C,{size:64,className:"mb-4 opacity-50"}),e.jsx("p",{className:"text-lg font-medium",children:r||l?"No se encontraron notas":"No tienes notas aún"}),e.jsx("p",{className:"text-sm mt-2",children:r||l?"Intenta con otros términos de búsqueda":"Toca un versículo para agregar tu primera nota"})]}):k.map(t=>e.jsx(M,{note:t,onDelete:a,onNotify:s,onUpdate:c},t.id))})]})},M=({note:s,onDelete:g,onNotify:N,onUpdate:r})=>{const[m,l]=i.useState(!1),[p,b]=i.useState(s.noteText),[u,j]=i.useState(s.tags.join(", ")),y=()=>{const a=u.split(",").map(f=>f.trim()).filter(Boolean);n.updateNote(s.id,{noteText:p,tags:a}),l(!1),r(),N("Nota actualizada","success")},c={yellow:"bg-yellow-50 dark:bg-yellow-900/20 border-yellow-200 dark:border-yellow-800",blue:"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",green:"bg-green-50 dark:bg-green-900/20 border-green-200 dark:border-green-800",purple:"bg-purple-50 dark:bg-purple-900/20 border-purple-200 dark:border-purple-800",red:"bg-red-50 dark:bg-red-900/20 border-red-200 dark:border-red-800",orange:"bg-orange-50 dark:bg-orange-900/20 border-orange-200 dark:border-orange-800"};return e.jsxs("div",{className:`rounded-xl border-2 p-4 transition-all ${c[s.color||"yellow"]}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm font-bold text-gray-700 dark:text-gray-300 mb-1",children:[e.jsx(R,{size:14}),s.bookName," ",s.chapterIndex+1,":",s.verseIndex+1]}),e.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400 italic line-clamp-2",children:['"',s.verseText,'"']})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>l(!m),className:"p-1.5 rounded-full hover:bg-black/10 dark:hover:bg-white/10 transition-colors",title:"Editar",children:m?e.jsx(U,{size:16}):e.jsx($,{size:16})}),e.jsx("button",{onClick:()=>g(s.id),className:"p-1.5 rounded-full hover:bg-red-500/20 text-red-600 transition-colors",title:"Eliminar",children:e.jsx(F,{size:16})})]})]}),m?e.jsxs("div",{className:"space-y-2",children:[e.jsx("textarea",{value:p,onChange:a=>b(a.target.value),className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white resize-none",rows:4}),e.jsx("input",{type:"text",value:u,onChange:a=>j(a.target.value),placeholder:"Etiquetas (separadas por comas)",className:"w-full p-2 rounded-lg border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-800 text-gray-900 dark:text-white text-sm"}),e.jsx("button",{onClick:y,className:"w-full py-2 bg-primary text-white rounded-lg font-medium hover:bg-primary/90 transition-colors",children:"Guardar Cambios"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-gray-800 dark:text-gray-200 mb-3 whitespace-pre-wrap",children:s.noteText}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("div",{className:"flex items-center gap-1 flex-wrap",children:s.tags.map(a=>e.jsxs("span",{className:"px-2 py-0.5 rounded-full bg-black/10 dark:bg-white/10 text-gray-700 dark:text-gray-300 font-medium",children:["#",a]},a))}),e.jsxs("div",{className:"flex items-center gap-1 text-gray-500 dark:text-gray-400",children:[e.jsx(q,{size:12}),new Date(s.updatedAt).toLocaleDateString()]})]})]})]})};export{Y as default};
